<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content='width=device-width' name='viewport'>
  <title>ESP32 Web Flasher</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script type="module" src="https://unpkg.com/esp-web-tools@10.1.1/dist/web/install-button.js?module"></script>
</head>

<body onload="checkSupported()">

  <div class="main">
    <h2>ESP32 Web Flasher</h2>
    <div id="flasher">
      <div class="container inst-button">
        <!-- The selectable builds -->
        <select id="ver" class="btn" onchange="setManifest()">
          <optgroup label="Startpad-LED-system">
            <option
              data-manifest="firmwares/Startpad-LED-system/1.1/manifest.json?v=1.33">
              Startpad-LED-system - v1.3</option>
          </optgroup>


        </select><br>

        <esp-web-install-button id="inst">
          <button class="btn" slot="activate">Connect</button>
        </esp-web-install-button><br>

      </div>

      <script>
        function setManifest() {
          var sel = document.getElementById('ver');
          var opt = sel.options[sel.selectedIndex];
          var m = opt.dataset.manifest;
          var me = opt.dataset.ethernet;
          document.getElementById('inst').setAttribute('manifest', m);
        }

        function checkSupported() {
          if (document.getElementById('inst').hasAttribute('install-unsupported')) unsupported();
          else setManifest();
        }

        function unsupported() {
          document.getElementById('flasher').innerHTML = "Your Browser is not supported!<br>Please use Desktop Chrome or Edge.<br>"
        }

        function showSerialHelp() {
          document.getElementById('coms').innerHTML = `To proceed, click "Connect" and then select the correct COM port.<br><br>
    you may need drivers for your board.<br>
    Here are links to USB to UART chips, which are often used on ESP32 boards:<br><br>
    <a href="https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers" target="_blank">CP2102</a><br>
    <a href="https://github.com/nodemcu/nodemcu-devkit/tree/master/Drivers" target="_blank">CH34x</a><br><br>
    Make sure, your USB cable is suitable for the selected transmission speed.<br><br>
    `;
        }
      </script>
</body>
</html>